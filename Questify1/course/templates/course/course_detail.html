{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
  <div class="card shadow-sm">
    <div class="card-body">
      <h2 class="card-title">{{ course.title }}</h2>

      <p><strong>–ü—Ä–µ–ø–æ–¥–∞–≤–∞—Ç–µ–ª—å:</strong> {{ course.teacher }}</p>

      <p><strong>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong>
        {% for cat in course.category.all %}
          {{ cat.name }}{% if not forloop.last %}, {% endif %}
        {% empty %}
          –ù–µ—Ç
        {% endfor %}
      </p>

      <p><strong>–£—Ä–æ–≤–µ–Ω—å:</strong> {{ course.get_level_display }}</p>
      <p><strong>–°—Ç–æ–∏–º–æ—Å—Ç—å:</strong> {{ course.price }} $</p>
      <hr>
      <p>{{ course.description }}</p>

      <!-- –°–ø–∏—Å–æ–∫ —É—Ä–æ–∫–æ–≤ -->
      <h4 class="mt-4">–°–ø–∏—Å–æ–∫ —É—Ä–æ–∫–æ–≤</h4>
      <ul class="list-group">
        {% for lesson in course.lessons.all %}
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <div>
              {% if user.is_authenticated and user.is_superuser or course.teacher == user or user in course.students.all %}
                <a href="{% url 'course:lesson_detail' course.pk lesson.pk %}">
                  {{ lesson.order }}. {{ lesson.title }}
                </a>
              {% else %}
                <span>{{ lesson.order }}. {{ lesson.title }}</span>
              {% endif %}
            </div>
            <small class="text-muted">{{ lesson.published|date:"Y-m-d" }}</small>
          </li>
        {% empty %}
          <li class="list-group-item">–£—Ä–æ–∫–æ–≤ –ø–æ–∫–∞ –Ω–µ—Ç.</li>
        {% endfor %}
      </ul>

      <!-- –ó–∞–ø–∏—Å—å –Ω–∞ –∫—É—Ä—Å -->
      {% if user.is_authenticated %}
        {% if user.role == "student" %}
          {% if user in course.students.all %}
            <p class="text-success mt-3">‚úÖ –í—ã –∑–∞–ø–∏—Å–∞–Ω—ã –Ω–∞ —ç—Ç–æ—Ç –∫—É—Ä—Å</p>
          {% else %}
            <a href="{% url 'course:enroll_course' course.id %}" class="btn btn-primary mt-3">–ó–∞–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –∫—É—Ä—Å</a>
          {% endif %}
        {% endif %}
      {% else %}
        <p class="mt-3 text-warning">–í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É, —á—Ç–æ–±—ã –∑–∞–ø–∏—Å–∞—Ç—å—Å—è –∏ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —É—Ä–æ–∫–∞–º.</p>
      {% endif %}

      <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∫—É—Ä—Å–∞ -->
      {% if course.outcome %}
        <h4 class="mt-4">üéì –†–µ–∑—É–ª—å—Ç–∞—Ç:</h4>
        <p>–ü–æ—Å–ª–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –∫—É—Ä—Å–∞ —Å—Ç—É–¥–µ–Ω—Ç —Å–º–æ–∂–µ—Ç:</p>
        <div class="card p-3 bg-light mb-3">
          {{ course.outcome|linebreaks }}
        </div>
      {% endif %}

    </div>
  </div>

  <a href="{% url 'course:course_list' %}" class="btn btn-secondary mt-3">‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É</a>
</div>
{% endblock %}
