{% extends "base.html" %}
{% load quiz_extras %}

{% block content %}
<h2>Пройти тест: {{ quiz.lesson.title }}</h2>

<form method="post">
    {% csrf_token %}
    <ol>
    {% for q in questions %}
        <li>
            <strong>{{ q.text }}</strong>
            <ul class="list-group list-group-flush">
                {% for option in "A,B,C,D"|split:"," %}
                    {% with q|get_option_text:option as option_text %}
                    <li
                        {% if completed %}
                            {% if option == q.correct_answer %}
                                style="background-color: #d4edda;"
                            {% elif student_answers|get_item:q.id == option %}
                                style="background-color: #f8d7da;"
                            {% endif %}
                        {% endif %}
                    >
                        <label>
                            <input type="radio" name="question_{{ q.id }}" value="{{ option }}"
                                {% if student_answers|get_item:q.id == option %}checked{% endif %}
                                {% if completed %}disabled{% endif %}>
                            {{ option_text }}
                        </label>
        </li>
        {% endwith %}
    {% endfor %}
            </ul>
        </li>
    {% endfor %}
    </ol>

    {% if not completed %}
        <button type="submit" class="btn btn-primary mt-3">Отправить ответы</button>
    {% else %}
        <h3>Результат: {{ score }} / {{ total }}</h3>
        <a href="{% url 'course:student_courses' %}" class="btn btn-secondary mt-3">← Назад к моим курсам</a>
    {% endif %}
</form>
{% endblock %}
